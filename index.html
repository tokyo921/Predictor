<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Aviator ‚Äî Simulador / Sinais (Fict√≠cio)</title>
<style>
  :root{
    --bg1: #081428;
    --bg2: #07121f;
    --card: rgba(255,255,255,0.04);
    --accent: #2ef0a6;
    --accent-2: #5aa7ff;
    --muted: #9fb3c8;
    --danger: #ff6b6b;
    --glass: rgba(255,255,255,0.04);
    --font-sans: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:var(--font-sans);background:linear-gradient(180deg,var(--bg1),var(--bg2));color:#eaf6ff}
  .wrap{max-width:1100px;margin:20px auto;padding:18px;display:grid;grid-template-columns: 2fr 1fr;gap:18px}
  @media (max-width:920px){ .wrap{grid-template-columns:1fr} }

  /* Header */
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  header h1{font-size:20px;margin:0;letter-spacing:0.4px}
  .theme-btn{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}

  /* Left panel (main game) */
  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);border-radius:14px;padding:16px;backdrop-filter:blur(6px)}
  .top-row{display:flex;gap:12px;align-items:center;justify-content:space-between}
  .multibox{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(0,0,0,0.18), rgba(255,255,255,0.01));box-shadow:inset 0 0 30px rgba(0,0,0,0.4)}
  .multiplier{font-size:64px;font-weight:800;letter-spacing:0.02em;color:var(--accent);text-shadow:0 8px 30px rgba(46,240,166,0.12)}
  .sub-muted{color:var(--muted);font-size:13px;margin-top:6px}
  .graph-wrap{width:320px;height:110px;border-radius:8px;padding:6px;background:linear-gradient(180deg, rgba(255,255,255,0.007), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center}
  .controls{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;justify-content:center}
  button.btn{padding:10px 18px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#03111a;box-shadow:0 8px 30px rgba(46,240,166,0.08)}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .btn-danger{background:linear-gradient(90deg,#ff7b7b,#ff5252);color:#2b0a0a}

  /* Bet area */
  .bet-row{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:12px}
  .bet-input{width:120px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.25);color:inherit;text-align:center;font-weight:700}
  .note{font-size:12px;color:var(--muted);margin-top:8px;text-align:center}

  /* Status bar */
  .status{display:flex;gap:12px;align-items:center;justify-content:center;margin-top:12px;color:var(--muted);font-size:13px}
  .pill{background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.03)}

  /* Right panel (chat + info) */
  .chat-title{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  .chat-box{height:460px;overflow:auto;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.008));border:1px solid rgba(255,255,255,0.03)}
  .msg{margin-bottom:10px;padding:8px;border-radius:8px;background:rgba(0,0,0,0.16);border:1px solid rgba(255,255,255,0.02)}
  .msg .who{font-weight:700;color:var(--accent-2);font-size:13px;margin-bottom:4px}
  .msg.win{border-left:4px solid #7ef59c}
  .msg.lose{border-left:4px solid #ff8b8b}
  .chat-form{display:flex;gap:8px;margin-top:8px}
  .chat-input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.2);color:inherit}
  .small{font-size:12px;color:var(--muted);text-align:center;margin-top:8px}

  /* Crash / success visual */
  .big-flash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none}
  .flash-circle{width:220px;height:220px;border-radius:50%;background:radial-gradient(circle, rgba(255,255,255,0.04), rgba(255,255,255,0));transform:scale(0);opacity:0}
  .flash-show{animation:flashIn .6s forwards}
  @keyframes flashIn{to{transform:scale(1);opacity:1}}
</style>
</head>
<body>

<header>
  <h1>üéØ Aviator ‚Äî Simulador Fict√≠cio</h1>
  <div>
    <button id="themeToggle" class="theme-btn">üåô Tema</button>
  </div>
</header>

<main class="wrap">
  <!-- Left: Visual + Controls -->
  <section class="panel">
    <div class="top-row">
      <div class="multibox">
        <div id="multiplier" class="multiplier">‚Äî</div>
        <div class="sub-muted">Multiplicador atual</div>
      </div>

      <div style="display:flex;flex-direction:column;gap:8px;align-items:center;">
        <div class="graph-wrap">
          <canvas id="graph" width="320" height="110"></canvas>
        </div>
        <div class="sub-muted" style="margin-top:6px">Visualiza√ß√£o da curva (simulada)</div>
      </div>
    </div>

    <div class="controls">
      <div style="display:flex;flex-direction:column;align-items:center">
        <div class="note">Aposta m√≠nima: <strong>30 MZN</strong></div>
        <div class="bet-row">
          <input id="betAmount" class="bet-input" type="number" min="30" value="30" />
        </div>
        <div class="note">Coloque aposta antes do in√≠cio da rodada</div>
      </div>
    </div>

    <div class="controls">
      <button id="placeBtn" class="btn btn-primary">Colocar Aposta</button>
      <button id="cashoutBtn" class="btn btn-ghost" disabled>Cashout</button>
      <button id="forceBtn" class="btn btn-danger" title="Gerar sinal / rodar" style="display:none">For√ßar rodada</button>
    </div>

    <div class="status" aria-live="polite">
      <div class="pill" id="phase">Fase: aguardando</div>
      <div class="pill" id="roundTime">Pr√≥xima em: --s</div>
      <div class="pill" id="playersFake">üë• -- online</div>
    </div>

    <div class="small" style="margin-top:10px">
      ‚ö†Ô∏è Simula√ß√£o/entretenimento ‚Äî Sem dinheiro real. N√£o h√° garantias.
    </div>
  </section>

  <!-- Right: Chat -->
  <aside class="panel">
    <div class="chat-title">
      <strong>Chat ao vivo (an√¥nimo)</strong>
      <div style="color:var(--muted);font-size:13px">Fakes &amp; jogadores</div>
    </div>

    <div id="chat" class="chat-box" aria-live="polite"></div>

    <div class="chat-form" style="margin-top:10px">
      <input id="chatInput" class="chat-input" placeholder="Mensagem (an√¥nima) ‚Äî ex.: 'Ganhei 90 MZN!'" />
      <button id="sendChat" class="btn btn-primary">Enviar</button>
    </div>

    <div class="small">Mensagens s√£o apenas locais / fict√≠cias.</div>
  </aside>
</main>

<!-- Flash when crash/cashout -->
<div id="flash" class="big-flash" aria-hidden="true">
  <div id="flashCircle" class="flash-circle"></div>
</div>

<script>
/*
Aviator-sim (fict√≠cio)
- rounds: pre-round (countdown), round (multiplier rises), crash (random)
- player can place bet (min 30) during pre-round
- player can cashout during round
- fake chat messages + fake online counter
- visually animated multiplier + simple canvas curve
*/

const MIN_BET = 30;
let state = {
  phase: 'waiting', // waiting / pre / running / crashed
  preTime: 6,       // seconds to place bets
  runInterval: null,
  roundTimer: 0,
  multiplier: 1.00,
  crashAt: null,
  betPlaced: false,
  betAmount: 0,
  hasCashedOut: false,
  players: 0
};

const multiplierEl = document.getElementById('multiplier');
const phaseEl = document.getElementById('phase');
const roundTimeEl = document.getElementById('roundTime');
const playersEl = document.getElementById('playersFake');
const betInput = document.getElementById('betAmount');
const placeBtn = document.getElementById('placeBtn');
const cashoutBtn = document.getElementById('cashoutBtn');
const chatBox = document.getElementById('chat');
const sendChat = document.getElementById('sendChat');
const chatInput = document.getElementById('chatInput');
const flash = document.getElementById('flash');
const flashCircle = document.getElementById('flashCircle');

const canvas = document.getElementById('graph');
const ctx = canvas.getContext('2d');

function rnd(min,max){return Math.random()*(max-min)+min}
function nice(n){ return (Math.round(n*100)/100).toFixed(2) + 'x'; }

function setPhase(p){
  state.phase = p;
  phaseEl.textContent = 'Fase: ' + (p === 'pre' ? 'apostando' : p === 'running' ? 'rodando' : p === 'crashed' ? 'crash' : 'aguardando');
}

function updatePlayers(){
  state.players = Math.floor(rnd(30, 220));
  playersEl.textContent = 'üë• ' + state.players + ' online';
}
setInterval(updatePlayers, 3000);
updatePlayers();

// Chat (fake messages generator)
const fakeMessages = [
  "Ganhei 120 MZN! üéâ",
  "Perdi tudo, crashou cedo üòÖ",
  "Cashout em 2.50x ‚Äî bom lucro",
  "Algu√©m t√° usando estrat√©gia martingale?",
  "30 MZN virou 150 MZN ‚úÖ",
  "Virei a noite jogando, sensacional!",
  "Cravou em 1.20x, perdi essa",
  "Vou aumentar pra 60 agora",
  "Algu√©m me d√° dica de cashout?",
  "Que rodada linda, 5.00x!"
];

function pushChat(name, text, cls=''){
  const el = document.createElement('div');
  el.className = 'msg ' + (cls||'');
  const who = document.createElement('div');
  who.className = 'who';
  who.textContent = name;
  const body = document.createElement('div');
  body.className = 'body';
  body.textContent = text;
  el.appendChild(who);
  el.appendChild(body);
  chatBox.appendChild(el);
  chatBox.scrollTop = chatBox.scrollHeight;
}

// Generate fake chat periodically
function spawnFakeChat(){
  const id = 'User' + Math.floor(rnd(1000,9999));
  const text = fakeMessages[Math.floor(Math.random() * fakeMessages.length)];
  const cls = text.toLowerCase().includes('ganhei') || text.includes('‚úÖ') ? 'win' : (text.toLowerCase().includes('perdi')?'lose':'');
  pushChat(id, text, cls);
}
setInterval(spawnFakeChat, 3500);
spawnFakeChat();

// Allow user to send anonymous chat
sendChat.addEventListener('click', ()=>{
  const txt = chatInput.value.trim();
  if(!txt) return;
  pushChat('Anon', txt);
  chatInput.value = '';
});

// Bet logic
placeBtn.addEventListener('click', ()=>{
  const val = Number(betInput.value);
  if(isNaN(val) || val < MIN_BET){
    alert('A aposta m√≠nima √© ' + MIN_BET + ' MZN');
    betInput.value = MIN_BET;
    return;
  }
  if(state.phase !== 'pre'){
    alert('S√≥ √© poss√≠vel apostar durante a fase de apostas (pr√©-rodada).');
    return;
  }
  state.betPlaced = true;
  state.betAmount = val;
  state.hasCashedOut = false;
  pushChat('Voc√™', `Colocou ${val} MZN na rodada`, 'win');
});

// Cashout
cashoutBtn.addEventListener('click', ()=>{
  if(state.phase !== 'running') return;
  if(!state.betPlaced || state.hasCashedOut) return;
  const payout = (state.betAmount * state.multiplier).toFixed(2);
  state.hasCashedOut = true;
  pushChat('Voc√™', `Cashout em ${state.multiplier.toFixed(2)}x ‚Üí Recebeu ${payout} MZN`, 'win');
  flashSuccess();
  cashoutBtn.disabled = true;
});

// Flash visual
function flashSuccess(color='#7ef59c'){
  flashCircle.style.background = `radial-gradient(circle, ${color}, rgba(0,0,0,0))`;
  flash.classList.add('flash-show');
  setTimeout(()=>{ flash.classList.remove('flash-show') }, 600);
}

// Round engine
let preTimer = null;
function startPreRound(){
  setPhase('pre');
  state.multiplier = 1.00;
  multiplierEl.textContent = nice(state.multiplier);
  roundTimeEl.textContent = 'Pr√≥xima em: ' + state.preTime + 's';
  let t = state.preTime;
  if(preTimer) clearInterval(preTimer);
  preTimer = setInterval(()=>{
    t--;
    roundTimeEl.textContent = 'Pr√≥xima em: ' + t + 's';
    if(t <= 0){
      clearInterval(preTimer);
      beginRound();
    }
  },1000);
}

let roundAnim = null;
let roundStart = null;

function beginRound(){
  setPhase('running');
  state.crashAt = Math.max(1.1, rnd(1.1, 10) * (Math.random() < 0.12 ? 0.6 : 1)); // random crash; some chance earlier
  // make occasional long rounds
  if(Math.random() < 0.06) state.crashAt *= rnd(1.5, 4);
  state.roundTimer = 0;
  roundStart = performance.now();
  cashoutBtn.disabled = false;
  // animate multiplier
  const start = performance.now();
  const speedFactor = rnd(0.8,1.4);
  // for graph
  graphData = [{x:0,y:1}];
  cancelAnimationFrame(roundAnim);
  function step(now){
    const elapsed = (now - start) / 1000 * speedFactor;
    // simple exponential-ish growth
    state.multiplier = Math.max(1 + elapsed * 0.6, Math.pow(1.02, elapsed*30));
    // draw graph
    drawGraph();
    multiplierEl.textContent = nice(state.multiplier);
    // update small status
    roundTimeEl.textContent = 'Rodando...';
    // check crash
    if(state.multiplier >= state.crashAt){
      // crash
      crashRound();
      return;
    }
    roundAnim = requestAnimationFrame(step);
  }
  roundAnim = requestAnimationFrame(step);
}

function crashRound(){
  setPhase('crashed');
  // if had bet and not cashed out -> lose
  if(state.betPlaced && !state.hasCashedOut){
    pushChat('Sistema', `Crash em ${state.crashAt.toFixed(2)}x ‚Äî sua aposta de ${state.betAmount} MZN perdeu.`, 'lose');
    flashSuccess('#ff8b8b');
  } else if(state.betPlaced && state.hasCashedOut){
    // already cashed out handled in cashout handler
  }
  // reset for next round after short pause
  cancelAnimationFrame(roundAnim);
  multiplierEl.textContent = nice(state.crashAt);
  cashoutBtn.disabled = true;
  // show crash marker in graph
  drawGraph(true);
  setTimeout(()=>{
    // reset bet flags
    state.betPlaced = false;
    state.betAmount = 0;
    state.hasCashedOut = false;
    startPreRound();
  }, 2500);
}

/* GRAPH: simple line that follows multiplier growth */
let graphData = [{x:0,y:1}];
function drawGraph(crash=false){
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);
  // background grid
  ctx.fillStyle = 'rgba(255,255,255,0.01)';
  ctx.fillRect(0,0,W,H);
  // push current multiplier to graphData
  const lastX = graphData.length ? graphData[graphData.length-1].x : 0;
  const xStep = 6; // px per point
  // scale multiplier to fit
  graphData.push({x:lastX + xStep, y: Math.min(state.multiplier, 12)});
  // trim
  if(graphData.length * xStep > W) graphData.shift();
  // compute maxY in view
  let maxY = 2;
  for(const p of graphData) if(p.y > maxY) maxY = p.y;
  maxY = Math.max(maxY, 3);
  // draw line
  ctx.beginPath();
  for(let i=0;i<graphData.length;i++){
    const p = graphData[i];
    const sx = (p.x / (graphData[graphData.length-1].x || 1)) * W;
    const sy = H - ( (p.y / maxY) * (H - 10) ) - 5;
    if(i===0) ctx.moveTo(sx, sy); else ctx.lineTo(sx, sy);
  }
  ctx.strokeStyle = 'rgba(46,240,166,0.9)';
  ctx.lineWidth = 2.4;
  ctx.stroke();
  // fill under curve
  ctx.lineTo(W, H); ctx.lineTo(0, H); ctx.closePath




